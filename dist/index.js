"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const noop=()=>{},emptyPromise=new Promise(noop);class AbortablePromise extends Promise{constructor(a){super(a),this._aborted=!1}static from(a){return a instanceof AbortablePromise?a:new AbortablePromise((b,c)=>a.then(b).catch(c))}_abort(){this._aborted=!0}_wrapHandler(a){return a?b=>{let c;try{c=a(b,()=>this._abort())}catch(a){if(!this._aborted)throw a}return this._aborted?emptyPromise:c}:a}then(a,b){return AbortablePromise.from(super.then(this._wrapHandler(a),this._wrapHandler(b)))}catch(a){return AbortablePromise.from(super.catch(this._wrapHandler(a)))}finally(a){return AbortablePromise.from(super.finally(this._wrapHandler(a)))}}exports.default=AbortablePromise;